<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ccRTP: rtppkt.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>rtppkt.h</h1><a href="rtppkt_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (C) 2002 Federico Montesino Pouzols &lt;fedemp@altern.org&gt;.</span>
<a name="l00002"></a>00002 <span class="comment">//</span>
<a name="l00003"></a>00003 <span class="comment">// This program is free software; you can redistribute it and/or modify</span>
<a name="l00004"></a>00004 <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l00005"></a>00005 <span class="comment">// the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00006"></a>00006 <span class="comment">// (at your option) any later version.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// This program is distributed in the hope that it will be useful,</span>
<a name="l00009"></a>00009 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00010"></a>00010 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00011"></a>00011 <span class="comment">// GNU General Public License for more details.</span>
<a name="l00012"></a>00012 <span class="comment">//</span>
<a name="l00013"></a>00013 <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l00014"></a>00014 <span class="comment">// along with this program; if not, write to the Free Software</span>
<a name="l00015"></a>00015 <span class="comment">// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
<a name="l00016"></a>00016 <span class="comment">//</span>
<a name="l00017"></a>00017 <span class="comment">// As a special exception, you may use this file as part of a free software</span>
<a name="l00018"></a>00018 <span class="comment">// library without restriction.  Specifically, if other files instantiate</span>
<a name="l00019"></a>00019 <span class="comment">// templates or use macros or inline functions from this file, or you compile</span>
<a name="l00020"></a>00020 <span class="comment">// this file and link it with other files to produce an executable, this</span>
<a name="l00021"></a>00021 <span class="comment">// file does not by itself cause the resulting executable to be covered by</span>
<a name="l00022"></a>00022 <span class="comment">// the GNU General Public License.  This exception does not however</span>
<a name="l00023"></a>00023 <span class="comment">// invalidate any other reasons why the executable file might be covered by</span>
<a name="l00024"></a>00024 <span class="comment">// the GNU General Public License.</span>
<a name="l00025"></a>00025 <span class="comment">//</span>
<a name="l00026"></a>00026 <span class="comment">// This exception applies only to the code released under the name GNU</span>
<a name="l00027"></a>00027 <span class="comment">// ccRTP.  If you copy code from other releases into a copy of GNU</span>
<a name="l00028"></a>00028 <span class="comment">// ccRTP, as the General Public License permits, the exception does</span>
<a name="l00029"></a>00029 <span class="comment">// not apply to the code that you add in this way.  To avoid misleading</span>
<a name="l00030"></a>00030 <span class="comment">// anyone as to the status of such modified files, you must delete</span>
<a name="l00031"></a>00031 <span class="comment">// this exception notice from them.</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="comment">// If you write modifications of your own for GNU ccRTP, it is your choice</span>
<a name="l00034"></a>00034 <span class="comment">// whether to permit this exception to apply to your modifications.</span>
<a name="l00035"></a>00035 <span class="comment">// If you do not wish that, delete this exception notice.</span>
<a name="l00036"></a>00036 <span class="comment">//</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#ifndef CCXX_RTP_RTPPKT_H_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#define CCXX_RTP_RTPPKT_H_</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="base_8h.html" title="Base elements for RTP stacks: constants, types and global functions.">ccrtp/base.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="formats_8h.html" title="Payload types and formats.">ccrtp/formats.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="_crypto_context_8h.html">ccrtp/CryptoContext.h</a>&gt;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#ifdef CCXX_NAMESPACES</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="keyword">namespace </span>ost {
<a name="l00047"></a>00047 <span class="preprocessor">#endif</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00073"></a>00073 <span class="keyword">class </span><a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="class_r_t_p_packet.html">00075</a> <span class="keyword">class  </span>__EXPORT <a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077 <span class="keyword">private</span>:
<a name="l00078"></a>00078         <span class="keyword">struct </span>RTPFixedHeader;
<a name="l00079"></a>00079         <span class="keyword">struct </span>RTPHeaderExt;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="keyword">public</span>:
<a name="l00094"></a>00094         <a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> block, <span class="keywordtype">size_t</span> len,
<a name="l00095"></a>00095                   <span class="keywordtype">bool</span> duplicate = <span class="keyword">false</span>);
<a name="l00096"></a>00096 
<a name="l00108"></a>00108         <a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>(<span class="keywordtype">size_t</span> hdrlen, <span class="keywordtype">size_t</span> plen, uint8 paddinglen, <a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc= NULL);
<a name="l00109"></a>00109 
<a name="l00116"></a>00116         <span class="keyword">inline</span> uint32
<a name="l00117"></a><a class="code" href="class_r_t_p_packet.html#a34704049dff7d2b02a5e8ca4da183049">00117</a>         getHeaderSize()<span class="keyword"> const</span>
<a name="l00118"></a>00118 <span class="keyword">        </span>{ <span class="keywordflow">return</span> hdrSize; }
<a name="l00119"></a>00119 
<a name="l00123"></a>00123         <span class="keyword">inline</span> <span class="keyword">const</span> uint8* <span class="keyword">const</span>
<a name="l00124"></a><a class="code" href="class_r_t_p_packet.html#a6572bf97b611f2f8d3646ebafa31e920">00124</a>         getPayload()<span class="keyword"> const</span>
<a name="l00125"></a>00125 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (uint8*)(buffer + getHeaderSize()); }
<a name="l00126"></a>00126 
<a name="l00130"></a>00130         <span class="keyword">inline</span> uint32
<a name="l00131"></a><a class="code" href="class_r_t_p_packet.html#a7149f4af4579d81f47e418cba45c8324">00131</a>         getPayloadSize()<span class="keyword"> const</span>
<a name="l00132"></a>00132 <span class="keyword">        </span>{ <span class="keywordflow">return</span> payloadSize; }
<a name="l00133"></a>00133 
<a name="l00137"></a>00137         <span class="keyword">inline</span> <a class="code" href="group__payload.html#ga0eee230c7ab57e31bb4e438a72354993" title="RTP payload type numeric identifier.">PayloadType</a>
<a name="l00138"></a><a class="code" href="class_r_t_p_packet.html#a1c6261da478d686c27f440e525ed829d">00138</a>         getPayloadType()<span class="keyword"> const</span>
<a name="l00139"></a>00139 <span class="keyword">        </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="group__payload.html#ga0eee230c7ab57e31bb4e438a72354993" title="RTP payload type numeric identifier.">PayloadType</a><span class="keyword">&gt;</span>(getHeader()-&gt;payload); }
<a name="l00140"></a>00140 
<a name="l00144"></a>00144         <span class="keyword">inline</span> uint16
<a name="l00145"></a><a class="code" href="class_r_t_p_packet.html#a3a71a859c29bbadde1f0d017e5f0cc29">00145</a>         getSeqNum()<span class="keyword"> const</span>
<a name="l00146"></a>00146 <span class="keyword">        </span>{ <span class="keywordflow">return</span> cachedSeqNum; }
<a name="l00147"></a>00147 
<a name="l00151"></a>00151         <span class="keyword">inline</span> uint32
<a name="l00152"></a><a class="code" href="class_r_t_p_packet.html#aa9f3afdc924b2ccf88d300fe2bfc0c24">00152</a>         getTimestamp()<span class="keyword"> const</span>
<a name="l00153"></a>00153 <span class="keyword">        </span>{ <span class="keywordflow">return</span> cachedTimestamp; }
<a name="l00154"></a>00154 
<a name="l00158"></a>00158         <span class="keyword">inline</span> uint8
<a name="l00159"></a><a class="code" href="class_r_t_p_packet.html#ade51a8ddb074d9f3e0fa46662a4fc234">00159</a>         getProtocolVersion()<span class="keyword"> const</span>
<a name="l00160"></a>00160 <span class="keyword">        </span>{ <span class="keywordflow">return</span> getHeader()-&gt;version; }
<a name="l00161"></a>00161 
<a name="l00166"></a>00166         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00167"></a><a class="code" href="class_r_t_p_packet.html#a90c9ad98f1010ed28df758d1eb2ae9d9">00167</a>         isPadded()<span class="keyword"> const</span>
<a name="l00168"></a>00168 <span class="keyword">        </span>{ <span class="keywordflow">return</span> getHeader()-&gt;padding; }
<a name="l00169"></a>00169 
<a name="l00176"></a>00176         <span class="keyword">inline</span> uint8
<a name="l00177"></a><a class="code" href="class_r_t_p_packet.html#afb0f7d944c6194ce6ba1e7cc1dd353c8">00177</a>         getPaddingSize()<span class="keyword"> const</span>
<a name="l00178"></a>00178 <span class="keyword">        </span>{ <span class="keywordflow">return</span> buffer[total - 1]; }
<a name="l00179"></a>00179 
<a name="l00186"></a>00186         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00187"></a><a class="code" href="class_r_t_p_packet.html#a85196cee7abac85077332181e955516b">00187</a>         isMarked()<span class="keyword"> const</span>
<a name="l00188"></a>00188 <span class="keyword">        </span>{ <span class="keywordflow">return</span> getHeader()-&gt;marker; }
<a name="l00189"></a>00189 
<a name="l00195"></a>00195         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00196"></a><a class="code" href="class_r_t_p_packet.html#aea83153299d9ab54dd3979375a810862">00196</a>         isExtended()<span class="keyword"> const</span>
<a name="l00197"></a>00197 <span class="keyword">        </span>{ <span class="keywordflow">return</span> getHeader()-&gt;extension; }
<a name="l00198"></a>00198 
<a name="l00203"></a>00203         <span class="keyword">inline</span> uint16
<a name="l00204"></a><a class="code" href="class_r_t_p_packet.html#a7ee5bdae05de8413fd4f5ab6af992f1c">00204</a>         getCSRCsCount()<span class="keyword"> const</span>
<a name="l00205"></a>00205 <span class="keyword">        </span>{ <span class="keywordflow">return</span> getHeader()-&gt;cc; }
<a name="l00206"></a>00206 
<a name="l00214"></a>00214         <span class="keyword">inline</span> <span class="keyword">const</span> uint32*
<a name="l00215"></a><a class="code" href="class_r_t_p_packet.html#a356ee03ec78f01a59579354d539e04c3">00215</a>         getCSRCs()<span class="keyword"> const</span>
<a name="l00216"></a>00216 <span class="keyword">        </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>uint32*<span class="keyword">&gt;</span>(&amp;(getHeader()-&gt;sources[1])); }
<a name="l00217"></a>00217 
<a name="l00230"></a>00230         <span class="keyword">inline</span> uint16
<a name="l00231"></a><a class="code" href="class_r_t_p_packet.html#a6f41c55d2c9ba5189187e6e8070a83f7">00231</a>         getHdrExtUndefined()<span class="keyword"> const</span>
<a name="l00232"></a>00232 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (isExtended()? getHeaderExt()-&gt;undefined : 0); }
<a name="l00233"></a>00233 
<a name="l00245"></a>00245         <span class="keyword">inline</span> uint32
<a name="l00246"></a><a class="code" href="class_r_t_p_packet.html#ab11662bd893855d4b96def573aa014bf">00246</a>         getHdrExtSize()<span class="keyword"> const</span>
<a name="l00247"></a>00247 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (isExtended()?
<a name="l00248"></a>00248                   (static_cast&lt;uint32&gt;(ntohs(getHeaderExt()-&gt;length)) &lt;&lt; 2) :
<a name="l00249"></a>00249                   0); }
<a name="l00250"></a>00250 
<a name="l00257"></a>00257         <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*
<a name="l00258"></a><a class="code" href="class_r_t_p_packet.html#a8ae29c378da3ff3d2937ecdb0e851551">00258</a>         getHdrExtContent()<span class="keyword"> const</span>
<a name="l00259"></a>00259 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (isExtended() ?
<a name="l00260"></a>00260                   (reinterpret_cast&lt;const unsigned char*&gt;(getHeaderExt()) +
<a name="l00261"></a>00261                    <span class="keyword">sizeof</span>(RTPHeaderExt)) :
<a name="l00262"></a>00262                   NULL); }
<a name="l00263"></a>00263 
<a name="l00270"></a>00270         <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span>
<a name="l00271"></a><a class="code" href="class_r_t_p_packet.html#a09baf36f8e117a89c290ba554600e6ea">00271</a>         getRawPacket()<span class="keyword"> const</span>
<a name="l00272"></a>00272 <span class="keyword">        </span>{ <span class="keywordflow">return</span> buffer; }
<a name="l00273"></a>00273 
<a name="l00280"></a>00280         <span class="keyword">inline</span> uint32
<a name="l00281"></a><a class="code" href="class_r_t_p_packet.html#afa64fc2a37bb9f0fbf4eed8d20654550">00281</a>         getRawPacketSize()<span class="keyword"> const</span>
<a name="l00282"></a>00282 <span class="keyword">        </span>{ <span class="keywordflow">return</span> total; }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         <span class="keyword">inline</span> uint32
<a name="l00285"></a><a class="code" href="class_r_t_p_packet.html#a1d08a1731bce4ccbbee25b5564ca9f91">00285</a>         getRawPacketSizeSrtp()<span class="keyword"> const</span>
<a name="l00286"></a>00286 <span class="keyword">        </span>{ <span class="keywordflow">return</span> total + srtpLength; }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288         <span class="keyword">inline</span> <span class="keywordtype">size_t</span>
<a name="l00289"></a><a class="code" href="class_r_t_p_packet.html#aeb4de98b3628912083ef602bccf921bb">00289</a>         getSizeOfFixedHeader()<span class="keyword"> const</span>
<a name="l00290"></a>00290 <span class="keyword">        </span>{ <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(RTPFixedHeader); }
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="keyword">protected</span>:
<a name="l00296"></a><a class="code" href="class_r_t_p_packet.html#ae5a7a96c6d05093c519041d209c1a98c">00296</a>         <span class="keyword">inline</span> <span class="keyword">virtual</span> ~<a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>()
<a name="l00297"></a>00297         { endPacket(); }
<a name="l00298"></a>00298 
<a name="l00302"></a>00302         <span class="keywordtype">void</span>
<a name="l00303"></a>00303         endPacket();
<a name="l00304"></a>00304 
<a name="l00310"></a>00310         <span class="keyword">inline</span> RTPFixedHeader*
<a name="l00311"></a><a class="code" href="class_r_t_p_packet.html#a4af0513f362d39a6b9a5b5c25d8d6cf6">00311</a>         getHeader()<span class="keyword"> const</span>
<a name="l00312"></a>00312 <span class="keyword">        </span>{ <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>RTPFixedHeader*<span class="keyword">&gt;</span>(buffer); }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00315"></a><a class="code" href="class_r_t_p_packet.html#aa023de7cea1a2cd67966751d7458eb68">00315</a>         setExtension(<span class="keywordtype">bool</span> e)
<a name="l00316"></a>00316         { getHeader()-&gt;extension = e; }
<a name="l00317"></a>00317 
<a name="l00325"></a>00325         <span class="keyword">inline</span> <span class="keyword">const</span> RTPHeaderExt*
<a name="l00326"></a><a class="code" href="class_r_t_p_packet.html#a1e6dc65620b39d7ec95279efda20fc79">00326</a>         getHeaderExt()<span class="keyword"> const</span>
<a name="l00327"></a>00327 <span class="keyword">        </span>{
<a name="l00328"></a>00328          uint32 fixsize = <span class="keyword">sizeof</span>(RTPFixedHeader) + (getHeader()-&gt;cc &lt;&lt; 2);
<a name="l00329"></a>00329          <span class="keywordflow">return</span> (reinterpret_cast&lt;RTPHeaderExt*&gt;(buffer + fixsize));
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331 
<a name="l00337"></a>00337         <span class="keyword">inline</span> uint32
<a name="l00338"></a><a class="code" href="class_r_t_p_packet.html#a11d159618b08f45e4bed5f2a5e76adfa">00338</a>         getRawTimestamp()<span class="keyword"> const</span>
<a name="l00339"></a>00339 <span class="keyword">        </span>{ <span class="keywordflow">return</span> ntohl(getHeader()-&gt;timestamp); }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00342"></a><a class="code" href="class_r_t_p_packet.html#a20885999c8f3c72dcf0b80c2b0091f99">00342</a>         setbuffer(<span class="keyword">const</span> <span class="keywordtype">void</span>* src, <span class="keywordtype">size_t</span> len, <span class="keywordtype">size_t</span> pos)
<a name="l00343"></a>00343         { memcpy(buffer + pos,src,len); }
<a name="l00344"></a>00344 
<a name="l00346"></a><a class="code" href="class_r_t_p_packet.html#ac8d0e7635320b6e1e800a6393c0fea49">00346</a>         uint16 cachedSeqNum;
<a name="l00348"></a><a class="code" href="class_r_t_p_packet.html#a5069f46d65d7beb0ec8d52884514f2c2">00348</a>         uint32 cachedTimestamp;
<a name="l00349"></a>00349 
<a name="l00356"></a><a class="code" href="class_r_t_p_packet.html#a0a1721f5d8a5f8b5fda2202152957c88">00356</a>         uint32 srtpDataOffset;
<a name="l00357"></a>00357 
<a name="l00363"></a><a class="code" href="class_r_t_p_packet.html#a08f18139adf266d2b0eba1aa7a753952">00363</a>         int32 srtpLength;
<a name="l00364"></a>00364 
<a name="l00366"></a><a class="code" href="class_r_t_p_packet.html#ad1d915ee852938db382dec87cdc5c12e">00366</a>         uint32 total;
<a name="l00367"></a>00367 
<a name="l00369"></a><a class="code" href="class_r_t_p_packet.html#a100e78d5c3b6e71fa548856bfbe3a43c">00369</a>         uint32 payloadSize;
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 <span class="keyword">private</span>:
<a name="l00373"></a>00373         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer;
<a name="l00375"></a>00375         uint32 hdrSize;
<a name="l00377"></a>00377         <span class="keywordtype">bool</span> duplicated;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="preprocessor">#ifdef  CCXX_PACKED</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span><span class="preprocessor">#pragma pack(1)</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span>
<a name="l00392"></a>00392         <span class="keyword">struct </span>RTPFixedHeader
<a name="l00393"></a>00393         {
<a name="l00394"></a>00394 <span class="preprocessor">#if     __BYTE_ORDER == __BIG_ENDIAN</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span>
<a name="l00396"></a>00396                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> version:2;       
<a name="l00397"></a>00397                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> padding:1;       
<a name="l00398"></a>00398                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> extension:1;     
<a name="l00399"></a>00399                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cc:4;            
<a name="l00400"></a>00400                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> marker:1;        
<a name="l00401"></a>00401                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> payload:7;       
<a name="l00402"></a>00402 <span class="preprocessor">#else</span>
<a name="l00403"></a>00403 <span class="preprocessor"></span>
<a name="l00404"></a>00404                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cc:4;            
<a name="l00405"></a>00405                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> extension:1;     
<a name="l00406"></a>00406                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> padding:1;       
<a name="l00407"></a>00407                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> version:2;       
<a name="l00408"></a>00408                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> payload:7;       
<a name="l00409"></a>00409                 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> marker:1;        
<a name="l00410"></a>00410 <span class="preprocessor">#endif</span>
<a name="l00411"></a>00411 <span class="preprocessor"></span>                uint16 sequence;        
<a name="l00412"></a>00412                 uint32 timestamp;       
<a name="l00413"></a>00413                 uint32 sources[1];      
<a name="l00414"></a>00414         };
<a name="l00415"></a>00415 
<a name="l00424"></a>00424 <span class="keyword">public</span>:
<a name="l00425"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html">00425</a>         <span class="keyword">struct </span><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html" title="a structure defining RFC2833 Telephony events.">RFC2833Payload</a>
<a name="l00426"></a>00426         {
<a name="l00427"></a>00427 <span class="preprocessor">#if __BYTE_ORDER == __BIG_ENDIAN</span>
<a name="l00428"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html#a7008fef4b50aab70b1ccb0714a939705">00428</a> <span class="preprocessor"></span>                uint8 <span class="keyword">event</span> : 8;
<a name="l00429"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html#ae262f9a7c7dbd2469c42a95f002664eb">00429</a>                 <span class="keywordtype">bool</span> ebit : 1;
<a name="l00430"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html#aacada6bfa031341dc0483dbbcf0d7d7a">00430</a>                 <span class="keywordtype">bool</span> rbit : 1;
<a name="l00431"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html#a72ab191de47a5242bbb8bd151e23fe46">00431</a>                 uint8 vol : 6;
<a name="l00432"></a><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html#a239bd053098d33a989457ee9051fbf2b">00432</a>                 uint16 duration : 16;
<a name="l00433"></a>00433 <span class="preprocessor">#else</span>
<a name="l00434"></a>00434 <span class="preprocessor"></span>                uint8 <span class="keyword">event</span> : 8;
<a name="l00435"></a>00435                 uint8 vol : 6;
<a name="l00436"></a>00436                 <span class="keywordtype">bool</span> rbit : 1;
<a name="l00437"></a>00437                 <span class="keywordtype">bool</span> ebit : 1;
<a name="l00438"></a>00438                 uint16 duration : 16;
<a name="l00439"></a>00439 <span class="preprocessor">#endif</span>
<a name="l00440"></a>00440 <span class="preprocessor"></span>        };
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="keyword">private</span>:
<a name="l00450"></a>00450         <span class="keyword">struct </span>RTPHeaderExt
<a name="l00451"></a>00451         {
<a name="l00452"></a>00452                 uint16 undefined; 
<a name="l00453"></a>00453                 uint16 length;    
<a name="l00454"></a>00454         };
<a name="l00455"></a>00455 <span class="preprocessor">#ifdef  CCXX_PACKED</span>
<a name="l00456"></a>00456 <span class="preprocessor"></span><span class="preprocessor">#pragma pack()</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span>
<a name="l00459"></a>00459         <span class="comment">/* definitions for access to most common 2833 fields... */</span>
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <span class="keyword">public</span>:
<a name="l00467"></a><a class="code" href="class_r_t_p_packet.html#aa4d765e540f6bc457828c7f475cd3f2b">00467</a>         <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html" title="a structure defining RFC2833 Telephony events.">RFC2833Payload</a> *getRaw2833Payload(<span class="keywordtype">void</span>)
<a name="l00468"></a>00468                 {<span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="struct_r_t_p_packet_1_1_r_f_c2833_payload.html" title="a structure defining RFC2833 Telephony events.">RFC2833Payload</a> *)getPayload();}
<a name="l00469"></a>00469 
<a name="l00475"></a><a class="code" href="class_r_t_p_packet.html#abbc4d9ea6aaa344f11e2e8ec72b73344">00475</a>         <span class="keyword">inline</span> uint16 get2833Duration(<span class="keywordtype">void</span>)
<a name="l00476"></a>00476                 {<span class="keywordflow">return</span> ntohs(getRaw2833Payload()-&gt;duration);}
<a name="l00477"></a>00477 
<a name="l00483"></a><a class="code" href="class_r_t_p_packet.html#a819b859d2afbb504a02b45e02f48bdfc">00483</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> set2833Duration(uint16 timestamp)
<a name="l00484"></a>00484                 {getRaw2833Payload()-&gt;duration = htons(timestamp);}
<a name="l00485"></a>00485 };
<a name="l00486"></a>00486 
<a name="l00497"></a><a class="code" href="class_outgoing_r_t_p_pkt.html">00497</a> <span class="keyword">class </span>__EXPORT <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a> : <span class="keyword">public</span> <a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499 <span class="keyword">public</span>:
<a name="l00526"></a>00526         <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>(<span class="keyword">const</span> uint32* <span class="keyword">const</span> csrcs, uint16 numcsrc,
<a name="l00527"></a>00527                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> hdrext, uint32 hdrextlen,
<a name="l00528"></a>00528                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> data, <span class="keywordtype">size_t</span> datalen,
<a name="l00529"></a>00529                        uint8 paddinglen= 0, <a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc= NULL);
<a name="l00530"></a>00530 
<a name="l00551"></a>00551         <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>(<span class="keyword">const</span> uint32* <span class="keyword">const</span> csrcs, uint16 numcsrc,
<a name="l00552"></a>00552                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> data, <span class="keywordtype">size_t</span> datalen,
<a name="l00553"></a>00553                        uint8 paddinglen= 0, <a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc= NULL);
<a name="l00554"></a>00554 
<a name="l00571"></a>00571         <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> data, <span class="keywordtype">size_t</span> datalen,
<a name="l00572"></a>00572                        uint8 paddinglen= 0, <a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc= NULL);
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#afba1782a1cd4472fcf4b9463de713ce5">00574</a>         ~<a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>()
<a name="l00575"></a>00575         { }
<a name="l00576"></a>00576 
<a name="l00580"></a>00580         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00581"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#ab7417e3c4cab407d67442b9de7742022">00581</a>         setPayloadType(<a class="code" href="group__payload.html#ga0eee230c7ab57e31bb4e438a72354993" title="RTP payload type numeric identifier.">PayloadType</a> pt)
<a name="l00582"></a>00582         { getHeader()-&gt;payload = pt; }
<a name="l00583"></a>00583 
<a name="l00589"></a>00589         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00590"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#a6e38f4cd65ef3fdbf833009d3891001e">00590</a>         setSeqNum(uint16 seq)
<a name="l00591"></a>00591         {
<a name="l00592"></a>00592                 cachedSeqNum = seq;
<a name="l00593"></a>00593                 getHeader()-&gt;sequence = htons(seq);
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595 
<a name="l00599"></a>00599         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00600"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#a385f04ff2e5c7c331e680007ed85273d">00600</a>         setTimestamp(uint32 pts)
<a name="l00601"></a>00601         {
<a name="l00602"></a>00602                 cachedTimestamp = pts;
<a name="l00603"></a>00603                 getHeader()-&gt;timestamp = htonl(pts);
<a name="l00604"></a>00604         }
<a name="l00605"></a>00605 
<a name="l00612"></a>00612         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00613"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#ac089f19969fa04270ccbd4369e16f345">00613</a>         setSSRC(uint32 ssrc)<span class="keyword"> const</span>
<a name="l00614"></a>00614 <span class="keyword">        </span>{ getHeader()-&gt;sources[0] = htonl(ssrc); }
<a name="l00615"></a>00615 
<a name="l00623"></a>00623         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00624"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#a4f6080b62bdbd2e1d6fec31e9509757b">00624</a>         setSSRCNetwork(uint32 ssrc)<span class="keyword"> const</span>
<a name="l00625"></a>00625 <span class="keyword">        </span>{ getHeader()-&gt;sources[0] = ssrc; }
<a name="l00626"></a>00626 
<a name="l00634"></a>00634         <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00635"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#a0dfc24975d352df2516635c3154c3221">00635</a>         setMarker(<span class="keywordtype">bool</span> mark)
<a name="l00636"></a>00636         { getHeader()-&gt;marker = mark; }
<a name="l00637"></a>00637 
<a name="l00644"></a>00644         <span class="keywordtype">void</span> protect(uint32 ssrc, <a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc);
<a name="l00645"></a>00645 
<a name="l00649"></a>00649         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00650"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#af6f3cd976367bd8347cc75a77557fb75">00650</a>         operator==(<span class="keyword">const</span> <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a> &amp;p)<span class="keyword"> const</span>
<a name="l00651"></a>00651 <span class="keyword">        </span>{ <span class="keywordflow">return</span> ( this-&gt;getSeqNum() == p.<a class="code" href="class_r_t_p_packet.html#a3a71a859c29bbadde1f0d017e5f0cc29">getSeqNum</a>() ); }
<a name="l00652"></a>00652 
<a name="l00656"></a>00656         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00657"></a><a class="code" href="class_outgoing_r_t_p_pkt.html#ac28297b7a9b2b49aeeada94cf3bf59bd">00657</a>         operator!=(<span class="keyword">const</span> <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a> &amp;p)<span class="keyword"> const</span>
<a name="l00658"></a>00658 <span class="keyword">        </span>{ <span class="keywordflow">return</span> ( this-&gt;getSeqNum() != p.<a class="code" href="class_r_t_p_packet.html#a3a71a859c29bbadde1f0d017e5f0cc29">getSeqNum</a>() ); }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 <span class="keyword">private</span>:
<a name="l00665"></a>00665         <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>(<span class="keyword">const</span> <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a> &amp;o);
<a name="l00666"></a>00666 
<a name="l00671"></a>00671         <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a>&amp;
<a name="l00672"></a>00672         operator=(<span class="keyword">const</span> <a class="code" href="class_outgoing_r_t_p_pkt.html" title="RTP packets being sent.">OutgoingRTPPkt</a> &amp;o);
<a name="l00673"></a>00673 
<a name="l00678"></a>00678         <span class="keywordtype">void</span> setCSRCArray(<span class="keyword">const</span> uint32* <span class="keyword">const</span> csrcs, uint16 numcsrc);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 };
<a name="l00681"></a>00681 
<a name="l00694"></a><a class="code" href="class_incoming_r_t_p_pkt.html">00694</a> <span class="keyword">class </span>__EXPORT <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a> : <span class="keyword">public</span> <a class="code" href="class_r_t_p_packet.html" title="A base class for both IncomingRTPPkt and OutgoingRTPPkt.">RTPPacket</a>
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696 <span class="keyword">public</span>:
<a name="l00709"></a>00709         <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* block, <span class="keywordtype">size_t</span> len);
<a name="l00710"></a>00710 
<a name="l00711"></a><a class="code" href="class_incoming_r_t_p_pkt.html#a2c81f3b5fb2c83bf07b254a656080c16">00711</a>         ~<a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a>()
<a name="l00712"></a>00712         { }
<a name="l00713"></a>00713 
<a name="l00719"></a>00719         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00720"></a><a class="code" href="class_incoming_r_t_p_pkt.html#a6e66b5f86f07fb30584e0ab2064da7e7">00720</a>         isHeaderValid()
<a name="l00721"></a>00721         { <span class="keywordflow">return</span> headerValid; }
<a name="l00722"></a>00722 
<a name="l00729"></a>00729         <span class="keyword">inline</span> uint32
<a name="l00730"></a><a class="code" href="class_incoming_r_t_p_pkt.html#a66459c52ff9cf1e22605b570b0235ded">00730</a>         getSSRC()<span class="keyword"> const</span>
<a name="l00731"></a>00731 <span class="keyword">        </span>{ <span class="keywordflow">return</span> cachedSSRC; }
<a name="l00732"></a>00732 
<a name="l00743"></a>00743         int32
<a name="l00744"></a>00744         unprotect(<a class="code" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a>* pcc);
<a name="l00745"></a>00745 
<a name="l00750"></a>00750         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00751"></a><a class="code" href="class_incoming_r_t_p_pkt.html#a4f993815747c556594158fe06acff748">00751</a>         operator==(<span class="keyword">const</span> <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a> &amp;p)<span class="keyword"> const</span>
<a name="l00752"></a>00752 <span class="keyword">        </span>{ <span class="keywordflow">return</span> ( (this-&gt;getSeqNum() == p.<a class="code" href="class_r_t_p_packet.html#a3a71a859c29bbadde1f0d017e5f0cc29">getSeqNum</a>()) &amp;&amp;
<a name="l00753"></a>00753                    (this-&gt;getSSRC() == p.<a class="code" href="class_incoming_r_t_p_pkt.html#a66459c52ff9cf1e22605b570b0235ded" title="Get synchronization source numeric identifier.">getSSRC</a>()) ); }
<a name="l00754"></a>00754 
<a name="l00759"></a>00759         <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00760"></a><a class="code" href="class_incoming_r_t_p_pkt.html#ab1c8c99a2f5e78d1ef722c32ea33e1b3">00760</a>         operator!=(<span class="keyword">const</span> <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a> &amp;p)<span class="keyword"> const</span>
<a name="l00761"></a>00761 <span class="keyword">        </span>{ <span class="keywordflow">return</span> !( *<span class="keyword">this</span> == p ); }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="keyword">private</span>:
<a name="l00768"></a>00768         <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a>(<span class="keyword">const</span> <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a> &amp;ip);
<a name="l00769"></a>00769 
<a name="l00774"></a>00774         <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a>&amp;
<a name="l00775"></a>00775         operator=(<span class="keyword">const</span> <a class="code" href="class_incoming_r_t_p_pkt.html" title="RTP packets received from other participants.">IncomingRTPPkt</a> &amp;ip);
<a name="l00776"></a>00776 
<a name="l00778"></a>00778         <span class="keywordtype">bool</span> headerValid;
<a name="l00780"></a>00780         uint32 cachedSSRC;
<a name="l00781"></a>00781         <span class="comment">// Masks for RTP header validation: types matching RTCP SR or</span>
<a name="l00782"></a>00782         <span class="comment">// RR must be rejected to avoid accepting misaddressed RTCP</span>
<a name="l00783"></a>00783         <span class="comment">// packets.</span>
<a name="l00784"></a>00784         <span class="keyword">static</span> <span class="keyword">const</span> uint16 RTP_INVALID_PT_MASK;
<a name="l00785"></a>00785         <span class="keyword">static</span> <span class="keyword">const</span> uint16 RTP_INVALID_PT_VALUE;
<a name="l00786"></a>00786 };
<a name="l00787"></a>00787  <span class="comment">// rtppacket</span>
<a name="l00789"></a>00789 
<a name="l00790"></a>00790 <span class="preprocessor">#ifdef  CCXX_NAMESPACES</span>
<a name="l00791"></a>00791 <span class="preprocessor"></span>}
<a name="l00792"></a>00792 <span class="preprocessor">#endif</span>
<a name="l00793"></a>00793 <span class="preprocessor"></span>
<a name="l00794"></a>00794 <span class="preprocessor">#endif  // ndef CCXX_RTP_RTPPKT_H_</span>
<a name="l00795"></a>00795 <span class="preprocessor"></span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Sep 21 04:20:08 2010 for ccRTP by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
