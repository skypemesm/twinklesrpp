<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ccRTP: CryptoContext Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CryptoContext Class Reference</h1><!-- doxytag: class="CryptoContext" -->
<p>The implementation for a SRTP cryptographic context.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_crypto_context_8h_source.html">CryptoContext.h</a>&gt;</code></p>

<p><a href="class_crypto_context-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a3d0b315c669e2fa9db608fe2e75a86ed">CryptoContext</a> (uint32 ssrc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for empty SRTP cryptographic context.  <a href="#a3d0b315c669e2fa9db608fe2e75a86ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#afaa485bb732b38de469a49781608eb4b">CryptoContext</a> (uint32 ssrc, int32 roc, int64 keyDerivRate, const int32 ealg, const int32 aalg, uint8 *masterKey, int32 masterKeyLength, uint8 *masterSalt, int32 masterSaltLength, int32 ekeyl, int32 akeyl, int32 skeyl, int32 tagLength)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for an active SRTP cryptographic context.  <a href="#afaa485bb732b38de469a49781608eb4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a63fb03214eabc114c4a0cfa6680822aa">~CryptoContext</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#a63fb03214eabc114c4a0cfa6680822aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a487be63a34aa9e110c6f42ffdaca663c">setRoc</a> (uint32 r)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the Roll-Over-Counter.  <a href="#a487be63a34aa9e110c6f42ffdaca663c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a09bf92748c04b963fbde556f926685d1">getRoc</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the Roll-Over-Counter.  <a href="#a09bf92748c04b963fbde556f926685d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a2c4bb98880d9a5a0c1d8d00b20013d1d">srtpEncrypt</a> (<a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *rtp, uint64 index, uint32 ssrc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform SRTP encryption.  <a href="#a2c4bb98880d9a5a0c1d8d00b20013d1d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a350d85f1664a989232c4b7a9f6971779">srtpAuthenticate</a> (<a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *rtp, uint32 roc, uint8 *tag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the authentication tag.  <a href="#a350d85f1664a989232c4b7a9f6971779"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#af816940dd663b8a52233edbc70838fc8">deriveSrtpKeys</a> (uint64 index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform key derivation according to SRTP specification.  <a href="#af816940dd663b8a52233edbc70838fc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a07107e1fb713bebd42ead4d333a3ce0d">guessIndex</a> (uint16 newSeqNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute (guess) the new SRTP index based on the sequence number of a received RTP packet.  <a href="#a07107e1fb713bebd42ead4d333a3ce0d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#aa71520de8edad991214440fafed3d8a7">checkReplay</a> (uint16 newSeqNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check for packet replay.  <a href="#aa71520de8edad991214440fafed3d8a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a679c6001b4fcd28e8f6ac4a1176b814d">update</a> (uint16 newSeqNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the SRTP packet index.  <a href="#a679c6001b4fcd28e8f6ac4a1176b814d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#ae24be85b1f7de8e9b1b50871026f397a">getTagLength</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the length of the SRTP authentication tag in bytes.  <a href="#ae24be85b1f7de8e9b1b50871026f397a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#ad26b194d81c2bd5b44274acfea0bb88f">getMkiLength</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the length of the MKI in bytes.  <a href="#ad26b194d81c2bd5b44274acfea0bb88f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#ab5959e7a14a8f820bac2ab8eb5c678b1">getSsrc</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the SSRC of this SRTP Cryptograhic context.  <a href="#ab5959e7a14a8f820bac2ab8eb5c678b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_crypto_context.html">CryptoContext</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_context.html#a0e73e1a81ca97b6c407cdafde809bd7a">newCryptoContextForSSRC</a> (uint32 ssrc, int roc, int64 keyDerivRate)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Derive a new Crypto Context for use with a new SSRC.  <a href="#a0e73e1a81ca97b6c407cdafde809bd7a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The implementation for a SRTP cryptographic context. </p>
<p>This class holds data and provides functions that implement a cryptographic context for SRTP, Refer to RFC 3711, chapter 3.2 for some more detailed information about the SRTP cryptographic context.</p>
<p>Each SRTP cryptographic context maintains a RTP source identified by its SSRC. Thus you can independently protect each source inside a RTP session.</p>
<p>Key management mechanisms negotiate the parameters for the SRTP cryptographic context, such as master key, key length, authentication length and so on. The key management mechanisms are not part of SRTP. Refer to MIKEY (RFC 3880) or to Phil Zimmermann's ZRTP protocol (draft-zimmermann-avt-zrtp-01). After key management negotiated the data the application can setup the SRTP cryptographic context and enable SRTP processing.</p>
<p>Currently this implementation supports RTP only, not RTCP.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Israel Abad &lt;<a href="mailto:i_abad@terra.es">i_abad@terra.es</a>&gt; </dd>
<dd>
Erik Eliasson &lt;<a href="mailto:eliasson@it.kth.se">eliasson@it.kth.se</a>&gt; </dd>
<dd>
Johan Bilien &lt;<a href="mailto:jobi@via.ecp.fr">jobi@via.ecp.fr</a>&gt; </dd>
<dd>
Joachim Orrblad &lt;<a href="mailto:joachim@orrblad.com">joachim@orrblad.com</a>&gt; </dd>
<dd>
Werner Dittmann &lt;<a href="mailto:Werner.Dittmann@t-online.de">Werner.Dittmann@t-online.de</a>&gt; </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3d0b315c669e2fa9db608fe2e75a86ed"></a><!-- doxytag: member="CryptoContext::CryptoContext" ref="a3d0b315c669e2fa9db608fe2e75a86ed" args="(uint32 ssrc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CryptoContext::CryptoContext </td>
          <td>(</td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>ssrc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor for empty SRTP cryptographic context. </p>
<p>This constructor creates an empty SRTP cryptographic context were all algorithms are set to the null algorithm, that is no SRTP processing is performed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ssrc</em>&nbsp;</td><td>The RTP SSRC that this SRTP cryptographic context protects. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afaa485bb732b38de469a49781608eb4b"></a><!-- doxytag: member="CryptoContext::CryptoContext" ref="afaa485bb732b38de469a49781608eb4b" args="(uint32 ssrc, int32 roc, int64 keyDerivRate, const int32 ealg, const int32 aalg, uint8 *masterKey, int32 masterKeyLength, uint8 *masterSalt, int32 masterSaltLength, int32 ekeyl, int32 akeyl, int32 skeyl, int32 tagLength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CryptoContext::CryptoContext </td>
          <td>(</td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>ssrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>roc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64&nbsp;</td>
          <td class="paramname"> <em>keyDerivRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32&nbsp;</td>
          <td class="paramname"> <em>ealg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32&nbsp;</td>
          <td class="paramname"> <em>aalg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&nbsp;</td>
          <td class="paramname"> <em>masterKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>masterKeyLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&nbsp;</td>
          <td class="paramname"> <em>masterSalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>masterSaltLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>ekeyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>akeyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>skeyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>tagLength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor for an active SRTP cryptographic context. </p>
<p>This constructor creates an active SRTP cryptographic context were algorithms are enabled, keys are computed and so on. This SRTP cryptographic context can protect a RTP SSRC stream.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ssrc</em>&nbsp;</td><td>The RTP SSRC that this SRTP cryptographic context protects.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>roc</em>&nbsp;</td><td>The initial Roll-Over-Counter according to RFC 3711. These are the upper 32 bit of the overall 48 bit SRTP packet index. Refer to chapter 3.2.1 of the RFC.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keyDerivRate</em>&nbsp;</td><td>The key derivation rate defines when to recompute the SRTP session keys. Refer to chapter 4.3.1 in the RFC.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ealg</em>&nbsp;</td><td>The encryption algorithm to use. Possible values are <code> SrtpEncryptionNull, SrtpEncryptionAESCM, SrtpEncryptionAESF8 </code>. See chapter 4.1.1 for AESCM (Counter mode) and 4.1.2 for AES F8 mode.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aalg</em>&nbsp;</td><td>The authentication algorithm to use. Possible values are <code> SrtpEncryptionNull, SrtpAuthenticationSha1Hmac</code>. The only active algorithm here is SHA1 HMAC, a SHA1 based hashed message authentication code as defined in RFC 2104.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>masterKey</em>&nbsp;</td><td>Pointer to the master key for this SRTP cryptographic context. Must point to <code>masterKeyLength</code> bytes. Refer to chapter 3.2.1 of the RFC about the role of the master key.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>masterKeyLength</em>&nbsp;</td><td>The length in bytes of the master key in bytes. The length must match the selected encryption algorithm. Because SRTP uses AES based encryption only, then master key length may be 16 or 32 bytes (128 or 256 bit master key)</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>masterSalt</em>&nbsp;</td><td>SRTP uses the master salt to computer the initialization vector that in turn is input to compute the session key, session authentication key and the session salt.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>masterSaltLength</em>&nbsp;</td><td>The length in bytes of the master salt data in bytes. SRTP uses AES as encryption algorithm. AES encrypts 16 byte blocks (independent of the key length). According to RFC3711 the standard value for the master salt length should be 112 bit (14 bytes).</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ekeyl</em>&nbsp;</td><td>The length in bytes of the session encryption key that SRTP shall compute and use. Usually the same length as for the master key length. But you may use a different length as well. Be carefull that the key management mechanisms supports different key lengths.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>akeyl</em>&nbsp;</td><td>The length in bytes of the session authentication key. SRTP computes this key and uses it as input to the authentication algorithm. The standard value is 160 bits (20 bytes).</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>skeyl</em>&nbsp;</td><td>The length in bytes of the session salt. SRTP computes this salt key and uses it as input during encryption. The length usually is the same as the master salt length.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tagLength</em>&nbsp;</td><td>The length is bytes of the authentication tag that SRTP appends to the RTP packet. Refer to chapter 4.2. in the RFC 3711. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a63fb03214eabc114c4a0cfa6680822aa"></a><!-- doxytag: member="CryptoContext::~CryptoContext" ref="a63fb03214eabc114c4a0cfa6680822aa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CryptoContext::~CryptoContext </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>
<p>Cleans the SRTP cryptographic context. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa71520de8edad991214440fafed3d8a7"></a><!-- doxytag: member="CryptoContext::checkReplay" ref="aa71520de8edad991214440fafed3d8a7" args="(uint16 newSeqNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptoContext::checkReplay </td>
          <td>(</td>
          <td class="paramtype">uint16&nbsp;</td>
          <td class="paramname"> <em>newSeqNumber</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check for packet replay. </p>
<p>The method check if a received packet is either to old or was already received.</p>
<p>The method supports a 64 packet history relative the the given sequence number.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>newSeqNumber</em>&nbsp;</td><td>The sequence number of the received RTP packet in host order.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>true</code> if no replay, <code>false</code> if packet is too old ar was already received. </dd></dl>

</div>
</div>
<a class="anchor" id="af816940dd663b8a52233edbc70838fc8"></a><!-- doxytag: member="CryptoContext::deriveSrtpKeys" ref="af816940dd663b8a52233edbc70838fc8" args="(uint64 index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CryptoContext::deriveSrtpKeys </td>
          <td>(</td>
          <td class="paramtype">uint64&nbsp;</td>
          <td class="paramname"> <em>index</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform key derivation according to SRTP specification. </p>
<p>This method computes the session key, session authentication key and the session salt key. This method must be called at least once after the SRTP Cryptograhic context was set up.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td>The 48 bit SRTP packet index. See the <code>guessIndex</code> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad26b194d81c2bd5b44274acfea0bb88f"></a><!-- doxytag: member="CryptoContext::getMkiLength" ref="ad26b194d81c2bd5b44274acfea0bb88f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 CryptoContext::getMkiLength </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the length of the MKI in bytes. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the length of the MKI. </dd></dl>

</div>
</div>
<a class="anchor" id="a09bf92748c04b963fbde556f926685d1"></a><!-- doxytag: member="CryptoContext::getRoc" ref="a09bf92748c04b963fbde556f926685d1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 CryptoContext::getRoc </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the Roll-Over-Counter. </p>
<p>Ths method get the upper 32 bit of the 48 bit SRTP packet index (the roll-over-part)</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The roll-over-counter </dd></dl>

</div>
</div>
<a class="anchor" id="ab5959e7a14a8f820bac2ab8eb5c678b1"></a><!-- doxytag: member="CryptoContext::getSsrc" ref="ab5959e7a14a8f820bac2ab8eb5c678b1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 CryptoContext::getSsrc </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the SSRC of this SRTP Cryptograhic context. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the SSRC. </dd></dl>

</div>
</div>
<a class="anchor" id="ae24be85b1f7de8e9b1b50871026f397a"></a><!-- doxytag: member="CryptoContext::getTagLength" ref="ae24be85b1f7de8e9b1b50871026f397a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 CryptoContext::getTagLength </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the length of the SRTP authentication tag in bytes. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the length of the authentication tag. </dd></dl>

</div>
</div>
<a class="anchor" id="a07107e1fb713bebd42ead4d333a3ce0d"></a><!-- doxytag: member="CryptoContext::guessIndex" ref="a07107e1fb713bebd42ead4d333a3ce0d" args="(uint16 newSeqNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64 CryptoContext::guessIndex </td>
          <td>(</td>
          <td class="paramtype">uint16&nbsp;</td>
          <td class="paramname"> <em>newSeqNumber</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute (guess) the new SRTP index based on the sequence number of a received RTP packet. </p>
<p>The method uses the algorithm show in RFC3711, Appendix A, to compute the new index.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>newSeqNumber</em>&nbsp;</td><td>The sequence number of the received RTP packet in host order.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The new SRTP packet index </dd></dl>

</div>
</div>
<a class="anchor" id="a0e73e1a81ca97b6c407cdafde809bd7a"></a><!-- doxytag: member="CryptoContext::newCryptoContextForSSRC" ref="a0e73e1a81ca97b6c407cdafde809bd7a" args="(uint32 ssrc, int roc, int64 keyDerivRate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_crypto_context.html">CryptoContext</a>* CryptoContext::newCryptoContextForSSRC </td>
          <td>(</td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>ssrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>roc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64&nbsp;</td>
          <td class="paramname"> <em>keyDerivRate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derive a new Crypto Context for use with a new SSRC. </p>
<p>This method returns a new Crypto Context initialized with the data of this crypto context. Replacing the SSRC, Roll-over-Counter, and the key derivation rate the application cab use this Crypto Context to encrypt / decrypt a new stream (Synchronization source) inside one RTP session.</p>
<p>Before the application can use this crypto context it must call the <code>deriveSrtpKeys</code> method.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ssrc</em>&nbsp;</td><td>The SSRC for this context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>roc</em>&nbsp;</td><td>The Roll-Over-Counter for this context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keyDerivRate</em>&nbsp;</td><td>The key derivation rate for this context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new <a class="el" href="class_crypto_context.html" title="The implementation for a SRTP cryptographic context.">CryptoContext</a> with all relevant data set. </dd></dl>

</div>
</div>
<a class="anchor" id="a487be63a34aa9e110c6f42ffdaca663c"></a><!-- doxytag: member="CryptoContext::setRoc" ref="a487be63a34aa9e110c6f42ffdaca663c" args="(uint32 r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CryptoContext::setRoc </td>
          <td>(</td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>r</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the Roll-Over-Counter. </p>
<p>Ths method sets the upper 32 bit of the 48 bit SRTP packet index (the roll-over-part)</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>r</em>&nbsp;</td><td>The roll-over-counter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a350d85f1664a989232c4b7a9f6971779"></a><!-- doxytag: member="CryptoContext::srtpAuthenticate" ref="a350d85f1664a989232c4b7a9f6971779" args="(RTPPacket *rtp, uint32 roc, uint8 *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CryptoContext::srtpAuthenticate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *&nbsp;</td>
          <td class="paramname"> <em>rtp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>roc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&nbsp;</td>
          <td class="paramname"> <em>tag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the authentication tag. </p>
<p>Compute the authentication tag according the the paramters in the SRTP Cryptograhic context.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rtp</em>&nbsp;</td><td>The RTP packet that contains the data to authenticate.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>roc</em>&nbsp;</td><td>The 32 bit SRTP roll-over-counter.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tag</em>&nbsp;</td><td>Points to a buffer that hold the computed tag. This buffer must be able to hold <code>tagLength</code> bytes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2c4bb98880d9a5a0c1d8d00b20013d1d"></a><!-- doxytag: member="CryptoContext::srtpEncrypt" ref="a2c4bb98880d9a5a0c1d8d00b20013d1d" args="(RTPPacket *rtp, uint64 index, uint32 ssrc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CryptoContext::srtpEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *&nbsp;</td>
          <td class="paramname"> <em>rtp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&nbsp;</td>
          <td class="paramname"> <em>ssrc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform SRTP encryption. </p>
<p>This method encrypts <em>and</em> decrypts SRTP payload data. Plain data gets encrypted, encrypted data get decrypted.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rtp</em>&nbsp;</td><td>The RTP packet that contains the data to encrypt.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td>The 48 bit SRTP packet index. See the <code>guessIndex</code> method.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ssrc</em>&nbsp;</td><td>The RTP SSRC data in <em>host</em> order. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a679c6001b4fcd28e8f6ac4a1176b814d"></a><!-- doxytag: member="CryptoContext::update" ref="a679c6001b4fcd28e8f6ac4a1176b814d" args="(uint16 newSeqNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CryptoContext::update </td>
          <td>(</td>
          <td class="paramtype">uint16&nbsp;</td>
          <td class="paramname"> <em>newSeqNumber</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the SRTP packet index. </p>
<p>Call this method after all checks were successful. See chapter 3.3.1 in the RFC when to update the ROC and ROC processing.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>newSeqNumber</em>&nbsp;</td><td>The sequence number of the received RTP packet in host order. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_crypto_context_8h_source.html">CryptoContext.h</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Sep 21 04:20:09 2010 for ccRTP by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
